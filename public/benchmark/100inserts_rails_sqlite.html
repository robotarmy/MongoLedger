<!DOCTYPE html>
<html>
  <head>
    <title></title>
  </head>
  <body>
    <nav> <!-- contains navigation related elements -->
    </nav>
    <div>
      <article> <!-- semantic wrapper for content -->
      </article>
    </div>
    <aside> <!-- tangent associated -->
    </aside>
  </body>
</html>
<!-- load javascript libraries late : optimization : may be extra -->
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
<!-- Important to ensure that javascript does not get executed out of order -->
<script type="text/javascript">
  //<![CDATA[
/* This is marked CDATA - it is not parsed by the x(ht)ml parser
   The above statement is marked as a javasript comment
   to prevent the javascript parser from interpteting it
 */
  var $ = jQuery;
  var Benchmark = function(){};
  Benchmark.constructor = Benchmark;
  Benchmark.prototype = {};
  Benchmark.prototype.run = function(count,callback) {
    var self = this;
    self.records['start'] = new Date().getTime();
    self.count = count;
      for(var i = 0; i < count; i++) {
        callback.apply(self,[i]);
      }
  };
  Benchmark.prototype.records = {};
  Benchmark.prototype.update_record_start = function(rid,start) {
    var self = this;

    self.records[rid] = {};
    self.records[rid].start = start
  };
  Benchmark.prototype.update_record_end = function(rid,end) {
    var self = this;
        self.records[rid].end = end; 
        self.records[rid].delta = end - self.records[rid].start ; 
        if (self.count-1 == rid) {
         self.records['finish'] = new Date().getTime();
         self.results('body article');
        }
  };
Benchmark.prototype.results = function(element) {
  var self = this;
  var div = $('<div></div>');
  setTimeout(function() {
      var tally = 0;
      var length = 0;
      var bstart =self.records.start;
      var bend = self.records.finish;
      delete self.records['start'];
      delete self.records['finish'];
      div.append($('<div> Real Elapsed Time '+((bend-bstart)/1000)+' seconds</div>'));
      for(var rec in self.records) {
        tally += self.records[rec].delta;
        length++; 
      }
      if (length != self.count) 
        throw "Count Mismatch";
      var calls = self.count;
      var average = tally / calls;
      div.append($('<div>'+tally+' ms</div>'));
      div.append($('<div>'+average+' average ms</div>'));
      div.append($('<div>'+calls+' calls</span>'));
      div.append($('<pre>'+JSON.stringify(self.records)+'</pre>'));
      $(element).append(div);
    },1);
  };
$(document).ready(function(){
    var doc = {
      name: 'This is a String value',
      name2: 'This is a String value2',
      number: 1000099042,
      number2: 199042,
      counter:0
    };
      var start = new Date().getTime();

    var inserts = new Benchmark();

    inserts.run(100,function(current_count) {
      var self = this;
      self.update_record_start(current_count,new Date().getTime());
      doc.counter = current_count;
      $.ajax({
        url: 'http://ledger.robotarmyma.de:5000/ledgers',
        type: 'POST',
        data: {json: JSON.stringify(doc)},
        success : function(data) { 
          var end = new Date().getTime();
          self.update_record_end(current_count,end);
        }
      });
      });
     });
/* CDATA line end cannot contain spaces or line breaks */
//]]>
</script>

